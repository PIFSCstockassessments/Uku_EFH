load("Data\DSH_2Qs=TRUE_RecEFF=Hours_OldSTART=1948.rds")
load(file="Data\DSH_2Qs=TRUE_RecEFF=Hours_OldSTART=1948.rds")
load(file="Data/DSH_2Qs=TRUE_RecEFF=Hours_OldSTART=1948.rds")
readRDS(file="Data/DSH_2Qs=TRUE_RecEFF=Hours_OldSTART=1948.rds")
M <- readRDS(file="Data/DSH_2Qs=TRUE_RecEFF=Hours_OldSTART=1948.rds")
View(M)
require(tidyverse); require(data.table)
M <- readRDS(file="Data/DSH_2Qs=TRUE_RecEFF=Hours_OldSTART=1948.rds")
MA.A <- M[[1]]
MP.A <- M[[2]]
MA.B <- M[[3]]
MP.B <- M[[4]]
MA.E <- M[[1]]
MP.L <- M[[2]]
MA.E <- M[[3]]
MP.L <- M[[4]]
MA.E@frame$FYEAR
View(MA.E@frame)
unique(MA.E@frame$FYEAR)
unique(MA.L@frame$FYEAR)
MA.E <- M[[1]]
MP.L <- M[[2]]
MA.E <- M[[3]]
MP.L <- M[[4]]
unique(MA.L@frame$FYEAR)
unique(MA.L@frame$FYEAR)
MA.E <- M[[1]]
MP.E <- M[[2]]
MA.L <- M[[3]]
MP.L <- M[[4]]
unique(MA.L@frame$FYEAR)
MA.L <- M[[1]]
MP.L <- M[[2]]
MA.E <- M[[3]]
MP.E <- M[[4]]
unique(MA.L@frame$FYEAR)
MA.O <- M[[1]]
MP.O <- M[[2]]
MA.R <- M[[3]]
MP.R <- M[[4]]
unique(MA.L@frame$FYEAR)
unique(MA.O@frame$FYEAR)
M <- readRDS(file="Data/DSH_2Qs=TRUE_RecEFF=Hours_OldSTART=1948.rds")
A <- M[[1]]
B <- M[[2]]
C <- M[[3]]
D <- M[[4]]
# Create a WLT from the dataset
WLT <- data.table( table(A@frame$FYEAR,A@frame$MONTH,A@frame$AREA_A)                                      )
A@frame$FYEAR
table(A@frame$FYEAR,A@frame$MONTH,A@frame$AREA_A)
table(A@frame$FYEAR)
table(A@frame$MONTH)
table(A@frame$AREA_A)
table(A@frame$`factor(MONTH)`)
# Create a WLT from the dataset
WLT <- data.table( table(A@frame$FYEAR,A@frame$`factor(MONTH)`,A@frame$AREA_A)    )
View(WLT)
# Create a WLT from the dataset
WLT.A <- data.table( table(A@frame$FYEAR,A@frame$`factor(MONTH)`,A@frame$AREA_A)    )
WLT.B <- data.table( table(B@frame$FYEAR,B@frame$`factor(MONTH)`,B@frame$AREA_A)    )
WLT.C <- data.table( table(C@frame$FYEAR,C@frame$`factor(MONTH)`,C@frame$AREA_A)    )
WLT.D <- data.table( table(D@frame$FYEAR,D@frame$`factor(MONTH)`,D@frame$AREA_A)    )
B$effects
B$model$FYEAR
B$model$`factor(MONTH)`
# Create a WLT from the dataset
WLT.A <- data.table( table(A@frame$FYEAR,A@frame$`factor(MONTH)`,A@frame$AREA_A)    )
WLT.B <- data.table( table(B$model$FYEAR,B$model$`factor(MONTH)`,B$model$AREA_A)    )
# Create a WLT from the dataset
WLT.A <- data.table( table(A@frame$FYEAR,A@frame$`factor(MONTH)`,A@frame$AREA_A)    )
WLT.B <- data.table( table(B$model$FYEAR,B$model$`factor(MONTH)`,B$model$AREA_A)    )
WLT.C <- data.table( table(C$model$FYEAR,C$model$`factor(MONTH)`,C$model$AREA_A)    )
WLT.D <- data.table( table(D@frame$FYEAR,D@frame$`factor(MONTH)`,D@frame$AREA_A)    )
# Create a WLT from the dataset
WLT.A <- data.table( table(A@frame$FYEAR,A@frame$`factor(MONTH)`,A@frame$AREA_A)    )
WLT.B <- data.table( table(B$model$FYEAR,B$model$`factor(MONTH)`,B$model$AREA_A)    )
WLT.C <- data.table( table(C@frame$FYEAR,C@frame$`factor(MONTH)`,C@frame$AREA_A)    )
WLT.D <- data.table( table(D$model$FYEAR,D$model$`factor(MONTH)`,D$model$AREA_A)    )
# Create a WLT from the dataset
WLT.A <- data.table( table(A@frame$FYEAR,A@frame$`factor(MONTH)`,A@frame$AREA_A)    );WLT.A <- select(WLT.A,-N)
WLT.B <- data.table( table(B$model$FYEAR,B$model$`factor(MONTH)`,B$model$AREA_A)    );WLT.B <- select(WLT.B,-N)
WLT.C <- data.table( table(C@frame$FYEAR,C@frame$`factor(MONTH)`,C@frame$AREA_A)    );WLT.C <- select(WLT.C,-N)
WLT.D <- data.table( table(D$model$FYEAR,D$model$`factor(MONTH)`,D$model$AREA_A)    );WLT.D <- select(WLT.D,-N)
View(WLT.D)
WLT.A <- data.table( table(A@frame$FYEAR,A@frame$`factor(MONTH)`,A@frame$AREA_A)    )
View(WLT.A)
# Create a WLT from the dataset
WLT.A <- data.table( table(A@frame$FYEAR,A@frame$`factor(MONTH)`,A@frame$AREA_A)    );WLT.A <- select(WLT.A,-N);setnames(WLT.A,c("FYEAR","factor(MONTH)","AREA_A"))
View(WLT.A)
WLT.A <- data.table( table(A@frame$FYEAR,A@frame$`factor(MONTH)`,A@frame$AREA_A)    );WLT.A <- select(WLT.A,-N);setnames(WLT.A,c("FYEAR","factor(MONTH)","AREA_A"))
WLT.B <- data.table( table(B$model$FYEAR,B$model$`factor(MONTH)`,B$model$AREA_A)    );WLT.B <- select(WLT.B,-N);setnames(WLT.B,c("FYEAR","factor(MONTH)","AREA_A"))
WLT.C <- data.table( table(C@frame$FYEAR,C@frame$`factor(MONTH)`,C@frame$AREA_A)    );WLT.C <- select(WLT.C,-N);setnames(WLT.C,c("FYEAR","factor(MONTH)","AREA_A"))
WLT.D <- data.table( table(D$model$FYEAR,D$model$`factor(MONTH)`,D$model$AREA_A)    );WLT.D <- select(WLT.D,-N);setnames(WLT.D,c("FYEAR","factor(MONTH)","AREA_A"))
View(WLT.D)
A@frame$`poly(PC1, 2, raw = T)`
median(A@frame$`poly(PC1, 2, raw = T)`)
WLT.A$'poly(PC1, 2, raw = T)' <- median(A@frame$`poly(PC1, 2, raw = T)`)
View(WLT.A)
WLT.A.PRED       <- predict.gam(A,newdata=WLT.A, se.fit=T)$fit
require(tidyverse); require(data.table); require(mgcv)
WLT.A.PRED       <- predict.gam(A,newdata=WLT.A, se.fit=T)$fit
WLT.A.PRED       <- predict(A,newdata=WLT.A, se.fit=T)$fit
WLT.A.PRED       <- predict(A,newdata=WLT.A)
View(A)
summary(A)
View(WLT.A)
WLT.A.PRED       <- predict(A,newdata=WLT.A)
# Create a WLT from the dataset
WLT.A <- data.table( table(A@frame$FYEAR,A@frame$`factor(MONTH)`,A@frame$AREA_A)    );WLT.A <- select(WLT.A,-N);setnames(WLT.A,c("FYEAR","MONTH","AREA_A"))
WLT.A$'poly(PC1, 2, raw = T)' <- median(A@frame$`poly(PC1, 2, raw = T)`)
WLT.A.PRED       <- predict(A,newdata=WLT.A)
# Create a WLT from the dataset
WLT.A <- data.table( table(A@frame$FYEAR,A@frame$`factor(MONTH)`,A@frame$AREA_A)    );WLT.A <- select(WLT.A,-N);setnames(WLT.A,c("FYEAR","MONTH","AREA_A"))
WLT.B <- data.table( table(B$model$FYEAR,B$model$`factor(MONTH)`,B$model$AREA_A)    );WLT.B <- select(WLT.B,-N);setnames(WLT.B,c("FYEAR","factor(MONTH)","AREA_A"))
WLT.C <- data.table( table(C@frame$FYEAR,C@frame$`factor(MONTH)`,C@frame$AREA_A)    );WLT.C <- select(WLT.C,-N);setnames(WLT.C,c("FYEAR","factor(MONTH)","AREA_A"))
WLT.D <- data.table( table(D$model$FYEAR,D$model$`factor(MONTH)`,D$model$AREA_A)    );WLT.D <- select(WLT.D,-N);setnames(WLT.D,c("FYEAR","factor(MONTH)","AREA_A"))
WLT.A$'PC1' <- median(A@frame$`poly(PC1, 2, raw = T)`)
WLT.A.PRED       <- predict(A,newdata=WLT.A)
@frame$FISHER
A@frame$FISHER
?mode
# Mode function
find_mode <- function(x) {
u   <- unique(x)
tab <- tabulate(match(x, u))
u[tab == max(tab)]
}
find_mode(A@frame$FISHER)
WLT.A$FISHER <- find_mode(A@frame$FISHER)
View(WLT.A)
WLT.A.PRED       <- predict(A,newdata=WLT.A)
WLT.A.PRED
WLT.A            <- cbind(WLT.A,WLT.A.PRED)
View(WLT.A)
View(WLT.A)
View(WLT.B)
View(B)
B$formula
WLT.B$PC1    <- median(B$model$`poly(PC1, 2, raw = T)`)
View(WLT.B)
WLT.B$PC2    <- median(B$model$`poly(PC2, 2, raw = T)`)
WLT.C$
C$formula
WLT.C$
C@frame
WLT.C$
C
A <- M[[1]]
B <- M[[2]]
C <- M[[3]]
D <- M[[4]]
WLT.C <- data.table( table(C@frame$FYEAR,C@frame$`factor(MONTH)`,C@frame$AREA_A)    );WLT.C <- select(WLT.C,-N);setnames(WLT.C,c("FYEAR","factor(MONTH)","AREA_A"))
WLT.C$
C
M <- readRDS(file="Data/DSH_2Qs=TRUE_RecEFF=Hours_OldSTART=1948.rds")
A <- M[[1]]
B <- M[[2]]
C <- M[[3]]
D <- M[[4]]
# Create a WLT from the dataset
WLT.A <- data.table( table(A@frame$FYEAR,A@frame$`factor(MONTH)`,A@frame$AREA_A)    );WLT.A <- select(WLT.A,-N);setnames(WLT.A,c("FYEAR","MONTH","AREA_A"))
WLT.B <- data.table( table(B$model$FYEAR,B$model$`factor(MONTH)`,B$model$AREA_A)    );WLT.B <- select(WLT.B,-N);setnames(WLT.B,c("FYEAR","factor(MONTH)","AREA_A"))
WLT.C <- data.table( table(C@frame$FYEAR,C@frame$`factor(MONTH)`,C@frame$AREA_A)    );WLT.C <- select(WLT.C,-N);setnames(WLT.C,c("FYEAR","factor(MONTH)","AREA_A"))
WLT.D <- data.table( table(D$model$FYEAR,D$model$`factor(MONTH)`,D$model$AREA_A)    );WLT.D <- select(WLT.D,-N);setnames(WLT.D,c("FYEAR","factor(MONTH)","AREA_A"))
WLT.C$
view(C)
WLT.C$
View(C)
WLT.C$
C
View(WLT.C)
table(C@frame$FYEAR,C@frame$`factor(MONTH)`,C@frame$AREA_A)
WLT.C$
C@call
WLT.C$
C@frame
require(tidyverse); require(data.table);
M <- readRDS(file="Data/DSH_2Qs=TRUE_RecEFF=Hours_OldSTART=1948.rds")
A <- M[[1]]
B <- M[[2]]
C <- M[[3]]
D <- M[[4]]
# Create a WLT from the dataset
WLT.A <- data.table( table(A@frame$FYEAR,A@frame$`factor(MONTH)`,A@frame$AREA_A)    );WLT.A <- select(WLT.A,-N);setnames(WLT.A,c("FYEAR","MONTH","AREA_A"))
WLT.B <- data.table( table(B$model$FYEAR,B$model$`factor(MONTH)`,B$model$AREA_A)    );WLT.B <- select(WLT.B,-N);setnames(WLT.B,c("FYEAR","factor(MONTH)","AREA_A"))
WLT.C <- data.table( table(C@frame$FYEAR,C@frame$`factor(MONTH)`,C@frame$AREA_A)    );WLT.C <- select(WLT.C,-N);setnames(WLT.C,c("FYEAR","factor(MONTH)","AREA_A"))
WLT.D <- data.table( table(D$model$FYEAR,D$model$`factor(MONTH)`,D$model$AREA_A)    );WLT.D <- select(WLT.D,-N);setnames(WLT.D,c("FYEAR","factor(MONTH)","AREA_A"))
# Mode function
find_mode <- function(x) {
u   <- unique(x)
tab <- tabulate(match(x, u))
u[tab == max(tab)]
}
WLT.A$PC1    <- median(A@frame$`poly(PC1, 2, raw = T)`)
WLT.A$FISHER <- find_mode(A@frame$FISHER)
WLT.B$PC1    <- median(B$model$`poly(PC1, 2, raw = T)`)
WLT.B$PC2    <- median(B$model$`poly(PC2, 2, raw = T)`)
WLT.C$
C@frame
WLT.C$
str(C)
WLT.C$
str(C)
C@call
find_mode(C@frame$FISHER)
WLT.C$SPEED  <- median(C@frame$WINDSPEED, raw = T)`)
WLT.C$SPEED  <- median(C@frame$WINDSPEED, raw = T)
WLT.C$SPEED  <- median(C@frame$SPEED, raw = T)
WLT.C$PC1    <- median(C$model$`poly(PC1, 2, raw = T)`)
WLT.C$PC1    <- median(C@frame$`poly(PC1, 2, raw = T)`)
View(WLT.C)
D$formula
View(WLT.C)
WLT.D$CUM_EXP <- median(D$model$`log(CUM_EXP)`)
WLT.D$PC1     <- median(D$model$`poly(PC1, 2, raw = T)`)
WLT.D$PC2     <- median(D$model$`poly(PC2, 2, raw = T)`)
View(WLT.D)
WLT.A.PRED       <- predict(A,newdata=WLT.A)
WLT.A            <- cbind(WLT.A,WLT.A.PRED)
WLT.B.PRED       <- predict(B,newdata=WLT.B)
require(tidyverse); require(data.table);
M <- readRDS(file="Data/DSH_2Qs=TRUE_RecEFF=Hours_OldSTART=1948.rds")
A <- M[[1]]
B <- M[[2]]
C <- M[[3]]
D <- M[[4]]
# Create a WLT from the dataset
WLT.A <- data.table( table(A@frame$FYEAR,A@frame$`factor(MONTH)`,A@frame$AREA_A)    );WLT.A <- select(WLT.A,-N);setnames(WLT.A,c("FYEAR","MONTH","AREA_A"))
WLT.B <- data.table( table(B$model$FYEAR,B$model$`factor(MONTH)`,B$model$AREA_A)    );WLT.B <- select(WLT.B,-N);setnames(WLT.B,c("FYEAR","MONTH","AREA_A"))
WLT.C <- data.table( table(C@frame$FYEAR,C@frame$`factor(MONTH)`,C@frame$AREA_A)    );WLT.C <- select(WLT.C,-N);setnames(WLT.C,c("FYEAR","MONTH","AREA_A"))
WLT.D <- data.table( table(D$model$FYEAR,D$model$`factor(MONTH)`,D$model$AREA_A)    );WLT.D <- select(WLT.D,-N);setnames(WLT.D,c("FYEAR","MONTH","AREA_A"))
# Mode f
# Mode function
find_mode <- function(x) {
u   <- unique(x)
tab <- tabulate(match(x, u))
u[tab == max(tab)]
}
WLT.A$PC1    <- median(A@frame$`poly(PC1, 2, raw = T)`)
WLT.A$FISHER <- find_mode(A@frame$FISHER)
WLT.B$PC1    <- median(B$model$`poly(PC1, 2, raw = T)`)
WLT.B$PC2    <- median(B$model$`poly(PC2, 2, raw = T)`)
WLT.C$FISHER <- find_mode(C@frame$FISHER)
WLT.C$SPEED  <- median(C@frame$SPEED, raw = T)
WLT.C$PC1    <- median(C@frame$`poly(PC1, 2, raw = T)`)
WLT.D$CUM_EXP <- median(D$model$`log(CUM_EXP)`)
WLT.D$PC1     <- median(D$model$`poly(PC1, 2, raw = T)`)
WLT.D$PC2     <- median(D$model$`poly(PC2, 2, raw = T)`)
WLT.A.PRED       <- predict(A,newdata=WLT.A)
WLT.A            <- cbind(WLT.A,WLT.A.PRED)
WLT.B.PRED       <- predict(B,newdata=WLT.B)
WLT.B            <- cbind(WLT.B,WLT.B.PRED)
WLT.C.PRED       <- predict(C,newdata=WLT.C)
WLT.C            <- cbind(WLT.C,WLT.C.PRED)
WLT.D.PRED       <- predict(D,newdata=WLT.D)
WLT.D            <- cbind(WLT.D,WLT.D.PRED)
View(WLT.C)
View(WLT.D)
View(WLT.A)
A@call
require(tidyverse); require(data.table);require(boot)
WLT.A$PC1    <- median(A@frame$`poly(PC1, 2, raw = T)`)
WLT.A$FISHER <- find_mode(A@frame$FISHER)
WLT.B$PC1    <- median(B$model$`poly(PC1, 2, raw = T)`)
WLT.B$PC2    <- median(B$model$`poly(PC2, 2, raw = T)`)
WLT.C$FISHER <- find_mode(C@frame$FISHER)
WLT.C$SPEED  <- median(C@frame$SPEED, raw = T)
WLT.C$PC1    <- median(C@frame$`poly(PC1, 2, raw = T)`)
WLT.D$CUM_EXP <- median(D$model$`log(CUM_EXP)`)
WLT.D$PC1     <- median(D$model$`poly(PC1, 2, raw = T)`)
WLT.D$PC2     <- median(D$model$`poly(PC2, 2, raw = T)`)
# Generate predictions
WLT.A.PRED       <- exp( predict(A,newdata=WLT.A) )
WLT.A            <- cbind(WLT.A,WLT.A.PRED)
WLT.B.PRED       <- predict(B,newdata=WLT.B)
WLT.B            <- inv.logit( cbind(WLT.B,WLT.B.PRED) )
# Create a WLT from the dataset
WLT.A <- data.table( table(A@frame$FYEAR,A@frame$`factor(MONTH)`,A@frame$AREA_A)    );WLT.A <- select(WLT.A,-N);setnames(WLT.A,c("FYEAR","MONTH","AREA_A"))
WLT.B <- data.table( table(B$model$FYEAR,B$model$`factor(MONTH)`,B$model$AREA_A)    );WLT.B <- select(WLT.B,-N);setnames(WLT.B,c("FYEAR","MONTH","AREA_A"))
WLT.C <- data.table( table(C@frame$FYEAR,C@frame$`factor(MONTH)`,C@frame$AREA_A)    );WLT.C <- select(WLT.C,-N);setnames(WLT.C,c("FYEAR","MONTH","AREA_A"))
WLT.D <- data.table( table(D$model$FYEAR,D$model$`factor(MONTH)`,D$model$AREA_A)    );WLT.D <- select(WLT.D,-N);setnames(WLT.D,c("FYEAR","MONTH","AREA_A"))
# Mode function
find_mode <- function(x) {
u   <- unique(x)
tab <- tabulate(match(x, u))
u[tab == max(tab)]
}
# Add the other explanatory variables
WLT.A$PC1    <- median(A@frame$`poly(PC1, 2, raw = T)`)
WLT.A$FISHER <- find_mode(A@frame$FISHER)
WLT.B$PC1    <- median(B$model$`poly(PC1, 2, raw = T)`)
WLT.B$PC2    <- median(B$model$`poly(PC2, 2, raw = T)`)
WLT.C$FISHER <- find_mode(C@frame$FISHER)
WLT.C$SPEED  <- median(C@frame$SPEED, raw = T)
WLT.C$PC1    <- median(C@frame$`poly(PC1, 2, raw = T)`)
WLT.D$CUM_EXP <- median(D$model$`log(CUM_EXP)`)
WLT.D$PC1     <- median(D$model$`poly(PC1, 2, raw = T)`)
WLT.D$PC2     <- median(D$model$`poly(PC2, 2, raw = T)`)
# Generate predictions
WLT.A.PRED       <- exp( predict(A,newdata=WLT.A) )
WLT.A            <- cbind(WLT.A,WLT.A.PRED)
WLT.B.PRED       <- predict(B,newdata=WLT.B)
WLT.B            <- inv.logit( cbind(WLT.B,WLT.B.PRED) )
WLT.A <- data.table( table(A@frame$FYEAR,A@frame$`factor(MONTH)`,A@frame$AREA_A)    );WLT.A <- select(WLT.A,-N);setnames(WLT.A,c("FYEAR","MONTH","AREA_A"))
WLT.B <- data.table( table(B$model$FYEAR,B$model$`factor(MONTH)`,B$model$AREA_A)    );WLT.B <- select(WLT.B,-N);setnames(WLT.B,c("FYEAR","MONTH","AREA_A"))
WLT.C <- data.table( table(C@frame$FYEAR,C@frame$`factor(MONTH)`,C@frame$AREA_A)    );WLT.C <- select(WLT.C,-N);setnames(WLT.C,c("FYEAR","MONTH","AREA_A"))
WLT.D <- data.table( table(D$model$FYEAR,D$model$`factor(MONTH)`,D$model$AREA_A)    );WLT.D <- select(WLT.D,-N);setnames(WLT.D,c("FYEAR","MONTH","AREA_A"))
# Mode function
find_mode <- function(x) {
u   <- unique(x)
tab <- tabulate(match(x, u))
u[tab == max(tab)]
}
# Add the other explanatory variables
WLT.A$PC1    <- median(A@frame$`poly(PC1, 2, raw = T)`)
WLT.A$FISHER <- find_mode(A@frame$FISHER)
WLT.B$PC1    <- median(B$model$`poly(PC1, 2, raw = T)`)
WLT.B$PC2    <- median(B$model$`poly(PC2, 2, raw = T)`)
WLT.C$FISHER <- find_mode(C@frame$FISHER)
WLT.C$SPEED  <- median(C@frame$SPEED, raw = T)
WLT.C$PC1    <- median(C@frame$`poly(PC1, 2, raw = T)`)
WLT.D$CUM_EXP <- median(D$model$`log(CUM_EXP)`)
WLT.D$PC1     <- median(D$model$`poly(PC1, 2, raw = T)`)
WLT.D$PC2     <- median(D$model$`poly(PC2, 2, raw = T)`)
# Generate predictions
WLT.A.PRED       <- exp( predict(A,newdata=WLT.A) )
WLT.A            <- cbind(WLT.A,WLT.A.PRED)
WLT.B.PRED       <- inv.logit( predict(B,newdata=WLT.B) )
WLT.B            <- cbind(WLT.B,WLT.B.PRED)
WLT.C.PRED       <- epx( predict(C,newdata=WLT.C) )
WLT.A <- data.table( table(A@frame$FYEAR,A@frame$`factor(MONTH)`,A@frame$AREA_A)    );WLT.A <- select(WLT.A,-N);setnames(WLT.A,c("FYEAR","MONTH","AREA_A"))
WLT.B <- data.table( table(B$model$FYEAR,B$model$`factor(MONTH)`,B$model$AREA_A)    );WLT.B <- select(WLT.B,-N);setnames(WLT.B,c("FYEAR","MONTH","AREA_A"))
WLT.C <- data.table( table(C@frame$FYEAR,C@frame$`factor(MONTH)`,C@frame$AREA_A)    );WLT.C <- select(WLT.C,-N);setnames(WLT.C,c("FYEAR","MONTH","AREA_A"))
WLT.D <- data.table( table(D$model$FYEAR,D$model$`factor(MONTH)`,D$model$AREA_A)    );WLT.D <- select(WLT.D,-N);setnames(WLT.D,c("FYEAR","MONTH","AREA_A"))
# Mode function
find_mode <- function(x) {
u   <- unique(x)
tab <- tabulate(match(x, u))
u[tab == max(tab)]
}
# Add the other explanatory variables
WLT.A$PC1    <- median(A@frame$`poly(PC1, 2, raw = T)`)
WLT.A$FISHER <- find_mode(A@frame$FISHER)
WLT.B$PC1    <- median(B$model$`poly(PC1, 2, raw = T)`)
WLT.B$PC2    <- median(B$model$`poly(PC2, 2, raw = T)`)
WLT.C$FISHER <- find_mode(C@frame$FISHER)
WLT.C$SPEED  <- median(C@frame$SPEED, raw = T)
WLT.C$PC1    <- median(C@frame$`poly(PC1, 2, raw = T)`)
WLT.D$CUM_EXP <- median(D$model$`log(CUM_EXP)`)
WLT.D$PC1     <- median(D$model$`poly(PC1, 2, raw = T)`)
WLT.D$PC2     <- median(D$model$`poly(PC2, 2, raw = T)`)
# Generate predictions
WLT.A.PRED       <- exp( predict(A,newdata=WLT.A) )
WLT.A            <- cbind(WLT.A,WLT.A.PRED)
WLT.B.PRED       <- inv.logit( predict(B,newdata=WLT.B) )
WLT.B            <- cbind(WLT.B,WLT.B.PRED)
WLT.C.PRED       <- exp( predict(C,newdata=WLT.C) )
WLT.C            <- cbind(WLT.C,WLT.C.PRED)
WLT.D.PRED       <- inv.logit( predict(D,newdata=WLT.D) )
WLT.D            <- cbind(WLT.D,WLT.D.PRED)
View(WLT.C)
View(WLT.D)
View(WLT.A)
View(WLT.A)
View(WLT.B)
WLT.OLD <- cbind(WLT.A,WLT.B)
View(WLT.OLD)
WLT.OLD$CPUE <- WLT.OLD$WLT.A.PRED*WLT.OLD$WLT.B.PRED
View(WLT.OLD)
WLT.OLD      <- select(WLT.OLD,1:3,CPUE)
View(WLT.OLD)
View(WLT.OLD)
WLT.REC      <- cbind(WLT.C,WLT.D)
WLT.REC$CPUE <- WLT.REC$WLT.A.PRED*WLT.REC$WLT.B.PRED
WLT.REC      <- select(WLT.REC,1:3,CPUE)
View(WLT.REC)
View(WLT.C)
View(WLT.D)
View(WLT.REC)
WLT.REC      <- cbind(WLT.C,WLT.D)
View(WLT.REC)
WLT.REC      <- cbind(WLT.C,WLT.D)
WLT.REC$CPUE <- WLT.REC$WLT.C.PRED*WLT.REC$WLT.D.PRED
WLT.REC      <- select(WLT.REC,1:3,CPUE)
View(WLT.REC)
View(WLT.OLD)
WLT.OLD.A <- WLT.OLD %>% group_by(MONTH,AREA) %>% summarize(CPUE=mean(CPUE))
WLT.OLD.A <- WLT.OLD %>% group_by(MONTH,AREA_A) %>% summarize(CPUE=mean(CPUE))
View(WLT.OLD.A)
WLT.REC.A <- WLT.REC %>% group_by(MONTH,AREA_A) %>% summarize(CPUE=mean(CPUE))
# Calculate CPUE indices by AREA
WLT.OLD.B  <- WLT.OLD.A %>% group_by(AREA_A)
# Calculate CPUE indices by AREA
WLT.OLD.B  <- WLT.OLD.A %>% group_by(AREA_A) %>% summarize(CPUE=mean(CPUE))
View(WLT.OLD.B)
WLT.REC.B  <- WLT.REC.A %>% group_by(AREA_A) %>% summarize(CPUE=mean(CPUE))
View(WLT.REC.B)
# Calculate CPUE indices by AREA
WLT.OLD.B  <- WLT.OLD %>% group_by(AREA_A) %>% summarize(CPUE=mean(CPUE))
WLT.REC.B  <- WLT.REC %>% group_by(AREA_A) %>% summarize(CPUE=mean(CPUE))
View(WLT.REC.B)
